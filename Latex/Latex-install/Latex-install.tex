\documentclass{article}

%-----------------------------------------------------------------
%package

%geometry
\usepackage[a4paper]{geometry}%调整页面边距
\geometry{left=3cm,right=3cm,top=2cm,bottom=3cm}
\linespread{1.5}
\usepackage{fancyhdr}%梦幻页眉

%fonts
\usepackage{fontspec}%字体库
\defaultfontfeatures{Mapping=tex-text}
\usepackage{xunicode,xltxtra}
\usepackage[BoldFont,SlantFont,CJKnumber,CJKchecksingle]{xeCJK}  % \CJKnumber{12345}: 一万二千三百四十五
\usepackage{bm} %公式中的粗体字符\boldsymbol
\usepackage{pifont}

%color
\usepackage{color,xcolor}
\definecolor{GREEN}{RGB}{25,180,68}
\definecolor{YELLOW}{RGB}{255,255,224}
\definecolor{BLUE}{RGB}{9,148,234}
\definecolor{RED}{RGB}{139,0,0}
\definecolor{DRED}{RGB}{128,0,0}
\usepackage[pagecolor={YELLOW}]{pagecolor}%设置页面底色

%math
\usepackage{amsmath,amsfonts,amssymb}

%graphics
\usepackage[americaninductors,europeanresistors]{circuitikz}
\usepackage{tikz}%可以绘制各种坐标图，方格图
\usetikzlibrary{positioning,arrows,shadows,shapes,calc,mindmap,trees,backgrounds}  % placements=positioning
\usepackage{graphicx}%\includegraphics插图命令
\usepackage{subfigure}  %%图形或表格并排排列

% table
\usepackage{colortbl,dcolumn}  %% 彩色表格
\usepackage{multirow}
\usepackage{multicol}
\usepackage{booktabs}

% code
\usepackage{fancyvrb}%漂亮的代码包
\usepackage{listings}%加入代码

% ref
\usepackage{hyperref}%扩展参考文献，目录功能和加入超链接。

% title
\usepackage{titlesec}%花哨的章节标题
%\titleformat{\paragraph}[runin]{\normalfont\scshape}{\S\,\oldstylenums{\thesection}.}{.5em}{}[.\quad]%从目录可直接打开章节号


%tightly-packed lists
\usepackage{mdwlist}
\usepackage{verbatim}%comment命令的注释包
\usepackage{styles/zhfontcfg}%中文包
\usepackage{styles/iplouclistings}
\usepackage{styles/iplouccfg}

% head/foot
\setlength{\headheight}{15pt}
\pagestyle{fancy}
\fancyhf{}

%--------------------------------------------------------------------------
%settings
\setCJKmainfont{Adobe Kaiti Std} %设置为楷体
\setCJKmonofont{Adobe Fangsong Std}%仿宋
%页眉页脚
\makeatletter
\def\headrule{{\if@fancyplain\let\headrulewidth\plainheadrulewidth\fi%
\hrule\@height 2.5pt \@width\headwidth\vskip1pt%上面线为1pt粗  
\hrule\@height 0.5pt\@width\headwidth  %下面0.5pt粗            
\vskip-2\headrulewidth\vskip-1pt}      %两条线的距离1pt        
\vspace{6mm}}     %双线与下面正文之间的垂直间距              
\makeatother         
                       
\chead{\color{RED}TEXLIVE2016-INSTALL}%页眉
\cfoot{\color{RED}July2016}%页脚 中
\lfoot{\color{RED}Changlin Dinghao}%页脚 左
\rfoot{\color{RED}$\cdot$\ Page\thepage\ }%页脚 右
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0.4pt}


% graphics
\graphicspath{{figures/}}
\tikzset{
    % Define standard arrow tip
    >=stealth',
    % Define style for boxes
    punkt/.style={
           rectangle,
           rounded corners,
           draw=black, very thick,
           text width=6.5em,
           minimum height=2em,
           text centered},
    % Define arrow style
    pil/.style={
           ->,
           thick,
           shorten <=2pt,
           shorten >=2pt,},
    % Define style for FlyZhyBall
    FlyZhyBall/.style={
      circle,
      minimum size=6mm,
      inner sep=0.5pt,
      ball color=red!50!blue,
      text=white,},
    % Define style for FlyZhyRectangle
    FlyZhyRectangle/.style={
      rectangle,
      rounded corners,
      minimum size=6mm,
      ball color=red!50!blue,
      text=white,},
    % Define style for zhyfly
    zhyfly/.style={
      rectangle,
      rounded corners,
      minimum size=6mm,
      ball color=red!25!blue,
      text=white,},
    % Define style for new rectangle
    nrectangle/.style={
      rectangle,
      draw=#1!50,
      fill=#1!20,
      minimum size=5mm,
      inner sep=0.1pt,}
}

% code
\lstnewenvironment{VHDLcode}[1][]{%
  \lstset{
    basicstyle=\footnotesize\ttfamily\color{black},%
    columns=flexible,%
    framexleftmargin=.7mm,frame=shadowbox,%
    rulesepcolor=\color{blue},%
%    frame=single,%
    backgroundcolor=\color{yellow!20},%
    xleftmargin=1.2\fboxsep,%
    xrightmargin=.7\fboxsep,%
    numbers=left,numberstyle=\tiny\color{blue},%
    numberblanklines=false,numbersep=7pt,%
    language=VHDL%
    }\lstset{#1}}{}

% pdf
\hypersetup{pdfauthor={Haiyong Zheng},%
            pdftitle={Title},%
            CJKbookmarks=true,%
            bookmarksnumbered=true,%
            bookmarksopen=false,%
            plainpages=false,%
            colorlinks=true,%
            citecolor=green,%
            filecolor=magenta,%
            linkcolor=DRED,%red(default)
            urlcolor=cyan}

\begin{document}
\title{\vspace{-2em}Ubuntu 16.04下安装TexLive2016并配置中文字体\vspace{0.7em}}%大标题
\author{常琳,丁昊}%作者
\date{\vspace{-0.7em}2016年7月\vspace{-0.7em}}%日期
\maketitle\thispagestyle{fancy}%在上部添加横线
\maketitle
\tableofcontents 


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{安装TexLive2016}

\begin{enumerate}
\item 下载TexLive2016镜像文件到/home/Texlive(这个是你自己建立的文件夹，不一定叫做Texlive)
\item 挂载镜像文件

挂载：在终端输入

sudo mount -o loop /home/changlin/software/texlive2016.iso /mnt

\item 进行安装

安装：在终端输入

\begin{lstlisting}
cd /mnt
sudo ./install-tl
\end{lstlisting}

安装后默认的安装目录是/usr/local，这里的一个习惯是把个人下载的应用安装到/opt下，以方便拷贝，如需要请参照文件夹中中文版readme在安装过程中进行设置。

注意：安装在opt下是需要在install那一步加入参数，不能简单的移动安装文件。

\item 测试

此时texlive就安装成功了，你可以在/home/tmp下新建一个test.tex的文档，比如

\begin{lstlisting}
\documentclass{article}
\begin{document}
This is a testing file!
\end{document}
\end{lstlisting}

然后打开终端输入

\begin{lstlisting}
cd /home/Texlive
xelatex test.tex
\end{lstlisting}

如果能生成一个PDF文件，里面的内容是"This is a testing file!" ，就说明安装成功了。

\end{enumerate}

\section{XeTeX中文配置}.


以下需要你建立的这个zhfontcfg.sty文件会随教程上传在github上，可以在styles文件夹中找到它。

\begin{enumerate}

\item 在所新建测试文档的目录中新建一个zhfontcfg.sty的文件，然后使用命令sudo mktexlsr更新一下，文件的内容如下，a,b可以二选一,目前我的电脑上用的是b里面的内容。[a方案似乎不能成功，要求转移的几个字体包在安装文件夹中也没能找到，目前没有找到解决方案]
\begin{enumerate}

\item[a]版本
\begin{lstlisting}
% xetex/xelatex 字体设定宏包
\ProvidesPackage{zhfontcfg}
\usepackage{fontspec,xunicode}
\usepackage[BoldFont,SlantFont,CJKnumber,CJKchecksingle]{xeCJK}  
\defaultfontfeatures{Mapping=tex-text}
%如果没有它，会有一些 tex 特殊字符无法正常使用，比如连字符。
%中文断行
\XeTeXlinebreaklocale "zh"
\XeTeXlinebreakskip = 0pt plus 1pt minus 0.1pt
\setCJKmainfont[BoldFont={SimHei}, ItalicFont={楷体_GB2312}]{SimSun}
\setCJKfamilyfont{song}{SimSun}
\setCJKfamilyfont{hei}{SimHei}
\setCJKfamilyfont{kai}{楷体_GB2312}
%楷体
\newcommand{\kai}{\CJKfamily{kai}} 
\def\kaishu{\kai}
%黑体
\newcommand{\hei}{\CJKfamily{hei}} 
\def\heiti{\hei}
%宋体
\newcommand{\song}{\CJKfamily{song}} 
\def\songti{\song}
\end{lstlisting}

将安装包里的simhei.ttf simsun.ttf 楷体\_GB2312.ttf文件复制到/usr/share/fonts/truetype下

sudo cp -a simhei.ttf simsun.ttf 楷体\_GB2312.ttf /usr/share/fonts/truetype

\item[b]版本
\begin{lstlisting}
% xetex/xelatex 字体设定宏包

\ProvidesPackage{zhfontcfg}

\usepackage{fontspec,xunicode,xltxtra}  % for XeTeX
\usepackage[BoldFont,SlantFont,CJKnumber,CJKchecksingle]{xeCJK}  

\defaultfontfeatures{Mapping=tex-text} 
%如果没有它，会有一些 tex 特殊字符无法正常使用，比如连字符。

% 中文断行
\XeTeXlinebreaklocale "zh"
\XeTeXlinebreakskip = 0pt plus 1pt minus 0.1pt

\setCJKmainfont[BoldFont={Adobe Heiti Std}, 
ItalicFont={Adobe Kaiti Std}]{Adobe Song Std}

\setCJKfamilyfont{song}{Adobe Song Std}
\setCJKfamilyfont{hei}{Adobe Heiti Std}
\setCJKfamilyfont{kai}{Adobe Kaiti Std}

%\setCJKmainfont[BoldFont={SimHei}, ItalicFont={楷体_GB2312}]{SimSun}

%\setCJKfamilyfont{song}{SimSun}
%\setCJKfamilyfont{hei}{SimHei}
%\setCJKfamilyfont{kai}{楷体_GB2312} 

%楷体
\newcommand{\kai}{\CJKfamily{kai}} 
\def\kaishu{\kai}
%黑体
\newcommand{\hei}{\CJKfamily{hei}} 
\def\heiti{\hei}
%宋体
\newcommand{\song}{\CJKfamily{song}} 
\def\songti{\song}
\end{lstlisting}
将Adobe-fonts-otf文件夹复制到/usr/share/fonts/truetype下

sudo cp -a Adobe-fonts-otf /usr/share/fonts/truetype

注意，Texlive2014版，这个文件夹就位于安装包中，但在16版安装后并没有这个文件夹，我的解决方案是对2014版安装后的该文件夹进行如上操作，该文件夹随本教程上传在github，如有更优方案请更新。

\end{enumerate}

\item 察看字体安装情况

在终端输入

fc-list :lang=zh-cn

查看是否成功安装了步骤1所需的对应字体

\item 测试

新建一个名为test2.tex的测试文档,文档内容为

\begin{lstlisting}
\documentclass{article}
\usepackage{zhfontcfg}
\begin{document}
中文测试
\end{document}
\end{lstlisting}

输入命令xelatex test2.tex，若生成一个内容为“中文测试”的PDF文档，则说明配置成功了, 如果不行，尝试再次编译，或重启下电脑试试。

注意，你的.tex文档应该与zhfontcfg.sty文件同在一个文件夹。

\end{enumerate}

\end{document}
